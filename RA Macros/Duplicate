let
    // Step 1: Get the user-defined directory path from cell C6 on the "Input" sheet
    SourceDirectory = Excel.CurrentWorkbook(){[Name="Input"]}[Content]{0}[Column1],

    // Step 2: Use the user-defined directory as the source to retrieve file information
    Source = Folder.Files(SourceDirectory),

    // Step 3: Select the columns you need (Name, Extension, Folder Path, Date created, Date modified)
    #"Removed Other Columns" = Table.SelectColumns(Source,{"Name", "Extension", "Folder Path", "Date created", "Date modified"}),

    // Step 4: Create a custom column "Counter" with the value 1 for counting purposes
    #"Added Counter" = Table.AddColumn(#"Removed Other Columns", "Counter", each 1),

    // Step 5: Remove the "Folder Path" column since we already have the information in the "Custom" column
    #"Removed Columns" = Table.RemoveColumns(#"Added Counter",{"Folder Path"}),

    // Step 6: Reorder the columns for better visibility
    #"Reordered Columns" = Table.ReorderColumns(#"Removed Columns",{"Name", "Date created", "Date modified", "Extension", "Counter"}),

    // Step 7: Extract the first 5 characters of the "Name" column to create the "Sec #" column
    #"Added Custom1" = Table.AddColumn(#"Reordered Columns", "Sec #", each Text.Start([Name], 5)),

    // Step 8: Reorder the columns again to place "Sec #" in the first column
    #"Reordered Columns1" = Table.ReorderColumns(#"Added Custom1",{"Sec #", "Name", "Date created", "Date modified", "Extension", "Counter"}),

    // Step 9: Add a custom column "Duplicate?" to indicate if a file has duplicates based on "Sec #"
    #"Added Custom2" = Table.AddColumn(#"Reordered Columns1", "Duplicate?", each if List.Count(List.Select(Source[#"Sec #"], each _ = [#"Sec #"])) > 1 then "Yes" else "No"),

    // Step 10: Rename the "Sec #" column to "Sec" for consistency
    #"Renamed Columns1" = Table.RenameColumns(#"Added Custom2",{{"Sec #", "Sec"}}),

    // Step 11: Remove the "Counter" column since it's not needed in the final output
    #"Removed Columns1" = Table.RemoveColumns(#"Renamed Columns1",{"Counter"}),

    // Step 12: Reorder columns again for the final output
    #"Reordered Columns2" = Table.ReorderColumns(#"Removed Columns1",{"Sec", "Name", "Date created", "Date modified", "Extension", "Duplicate?"})
in
    #"Reordered Columns2"
